---
title: æ„å»ºå¤šæ™ºèƒ½ä½“ä»£ç å®¡æŸ¥æµæ°´çº¿
description: ä½¿ç”¨ AgentTeam å’Œ TeamRunner ç¼–æ’ Lead â†’ Worker â†’ Reviewer æµæ°´çº¿ï¼šè‡ªåŠ¨åˆ†è§£ç›®æ ‡ã€å¹¶è¡Œæ‰§è¡Œä»»åŠ¡ï¼Œå¹¶å¯¹æ¯ä¸ªç»“æœè¿›è¡Œè´¨é‡æŠŠå…³ï¼Œç¡®è®¤é€šè¿‡åæ‰æ ‡è®°ä¸ºå®Œæˆã€‚
full: true
---

import { Step, Steps } from 'fumadocs-ui/components/steps';
import { Callout } from 'fumadocs-ui/components/callout';
import { Tab, Tabs } from 'fumadocs-ui/components/tabs';

æœ¬æ•™ç¨‹å°†æ„å»ºä¸€ä¸ªç”±ä¸‰ä¸ª AI æ™ºèƒ½ä½“ååŒå·¥ä½œçš„**è‡ªåŠ¨åŒ–ä»£ç å®¡æŸ¥æµæ°´çº¿**ï¼š

1. **Lead** æ™ºèƒ½ä½“å°†å®è§‚ç›®æ ‡ï¼ˆ"å®¡æŸ¥ auth æ¨¡å—"ï¼‰åˆ†è§£ä¸ºå…·ä½“ã€ç‹¬ç«‹çš„ä»»åŠ¡
2. **Worker** æ™ºèƒ½ä½“ä»å…±äº«ä»»åŠ¡æ¿ä¸Šè®¤é¢†ä»»åŠ¡å¹¶å¹¶è¡Œæ‰§è¡Œ
3. **Reviewer** æ™ºèƒ½ä½“é€ä¸€æ£€æŸ¥æ¯ä¸ªæ‰§è¡Œç»“æœï¼Œ**é€šè¿‡**åˆ™æ ‡è®°ä¸º Doneï¼Œ**æ‹’ç»**åˆ™é‡æ–°å…¥é˜Ÿç­‰å¾…é‡è¯•

æµæ°´çº¿æŒç»­è¿è¡Œï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡å®Œæˆâ€”â€”æˆ–è€…è¾¾åˆ° `max_rounds` ä¸Šé™ä¸ºæ­¢ã€‚

<Callout type="info">
  å…ˆå®‰è£… SDKï¼š`pip install a3s-code`ã€‚åœ¨ `~/.a3s/config.hcl` ä¸­é…ç½® LLM æä¾›å•†å¯†é’¥ã€‚
</Callout>

---

## å·¥ä½œåŸç†

```
ç›®æ ‡
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     JSON ä»»åŠ¡åˆ—è¡¨
â”‚  Lead LLM   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
                                                      â–¼
                                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                             â”‚  TeamTaskBoard  â”‚
                                             â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                                             â”‚  â”‚  task-1   â”‚  â”‚ Open
                                             â”‚  â”‚  task-2   â”‚  â”‚ Open
                                             â”‚  â”‚  task-3   â”‚  â”‚ Open
                                             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚ claim()
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
              â–¼              â–¼              â–¼         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
        â”‚ Worker 1 â”‚  â”‚ Worker 2 â”‚  â”‚ Worker 3 â”‚â—„â”€â”€â”€â”˜
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
             â”‚              â”‚              â”‚ complete()
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼ InReview
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   Reviewer    â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â–¼                               â–¼
                   é€šè¿‡ (APPROVED)              æ‹’ç» (REJECTED)
                   (â†’ Done)              (â†’ å›åˆ° Openï¼Œé‡æ–°è®¤é¢†)
```

---

## æ“ä½œæ¼”ç¤º

<ScrollyCoding>
<ScrollySteps>

<ScrollyStep index={0}>

### é¡¹ç›®ç»“æ„

ä»…éœ€ä¸¤ä¸ªæ–‡ä»¶ï¼š`agent.hcl` é…ç½® LLM æä¾›å•†ï¼Œ`review.py` å®ç°æµæ°´çº¿é€»è¾‘ã€‚

æ— éœ€ Lane é˜Ÿåˆ—æˆ–å¤–éƒ¨å·¥ä½œè¿›ç¨‹â€”â€”TeamRunner ä½¿ç”¨ Tokio ä»»åŠ¡åœ¨è¿›ç¨‹å†…å¤„ç†æ‰€æœ‰å¹¶å‘ã€‚

</ScrollyStep>

<ScrollyStep index={1}>

### æ™ºèƒ½ä½“é…ç½®ï¼ˆHCLï¼‰

`agent.hcl` åªéœ€é…ç½®æä¾›å•†å’Œæ¨¡å‹ã€‚å›¢é˜Ÿåä½œå®Œå…¨åœ¨è¿›ç¨‹å†…å®Œæˆï¼Œæ— éœ€ Lane é˜Ÿåˆ—ï¼ˆé™¤ééœ€è¦é™åˆ¶ LLM è°ƒç”¨é€Ÿç‡ï¼‰ã€‚

ä¸‰ä¸ªè§’è‰²ï¼ˆLeadã€Workerã€Reviewerï¼‰å…±ç”¨åŒä¸€å¥—é…ç½®ï¼Œæ¯ä¸ªè§’è‰²æ‹¥æœ‰ç‹¬ç«‹çš„ `AgentSession` å’Œç‹¬ç«‹çš„ä¸Šä¸‹æ–‡çª—å£ã€‚

</ScrollyStep>

<ScrollyStep index={2}>

### æ„å»ºå›¢é˜Ÿ

åˆ›å»º `AgentTeam`ï¼Œæ·»åŠ æˆå‘˜å¹¶æŒ‡å®šè§’è‰²ï¼Œç„¶ååŒ…è£…è¿› `TeamRunner`ã€‚

ä¼ å…¥ `TeamRunner` åï¼Œteam å¯¹è±¡å³è¢«**æ¶ˆè€—**â€”â€”ä¹‹åå†è°ƒç”¨ `team.add_member()` ä¼šæŠ¥é”™ã€‚

- **`max_rounds`** â€” Reviewer è½®è¯¢è½®æ•°ä¸Šé™ï¼Œè¶…è¿‡åˆ™æ”¾å¼ƒç­‰å¾…ä¸­çš„ä»»åŠ¡ï¼ˆé»˜è®¤å€¼ï¼š10ï¼‰
- **`poll_interval_ms`** â€” Worker å’Œ Reviewer æ£€æŸ¥æ–°ä»»åŠ¡çš„é—´éš”ï¼ˆé»˜è®¤å€¼ï¼š200 æ¯«ç§’ï¼‰

</ScrollyStep>

<ScrollyStep index={3}>

### ç»‘å®š Session

æ¯ä¸ªæˆå‘˜éœ€è¦ä¸€ä¸ª `Session` ä½œä¸ºå…¶ LLM æ‰§è¡Œå™¨ã€‚å¯¹æ¯ä¸ªè§’è‰²è°ƒç”¨ä¸€æ¬¡ `agent.session(workspace)`ã€‚

`bind_session` ä¼šéªŒè¯æˆå‘˜ ID æ˜¯å¦å­˜åœ¨äºå›¢é˜Ÿä¸­ï¼Œå¹¶åœ¨å†…éƒ¨å­˜å‚¨è¯¥ Sessionã€‚
æ‰§è¡Œç±»ä¼¼ä»»åŠ¡çš„ Worker ç”šè‡³å¯ä»¥å…±äº«åŒä¸€ä¸ª Session å¯¹è±¡â€”â€”Runner ä¼šåœ¨ Tokio ä»»åŠ¡ä¹‹é—´å¹¶å‘è°ƒç”¨ `session.send()`ã€‚

</ScrollyStep>

<ScrollyStep index={4}>

### è¿è¡Œå·¥ä½œæµ

`runner.run_until_done(goal)` ä¼šé˜»å¡ç›´åˆ°æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼ˆæˆ– `max_rounds` åˆ°æœŸï¼‰ã€‚

å†…éƒ¨æ‰§è¡Œé€»è¾‘ï¼š
1. Lead æ”¶åˆ°è§„åˆ’æç¤ºï¼Œè¿”å› `{"tasks": ["...", "..."]}` â€” Runner è‡ªåŠ¨è§£ææ­¤ JSON
2. Worker ä»»åŠ¡å¹¶å‘å¯åŠ¨ï¼Œå„è‡ªè½®è¯¢ä»»åŠ¡æ¿
3. Reviewer ä»»åŠ¡å¹¶è¡Œè¿è¡Œï¼Œå¯¹æ¯ä¸ª InReview çŠ¶æ€çš„ä»»åŠ¡è¿›è¡Œå®¡æ‰¹æˆ–æ‹’ç»

</ScrollyStep>

<ScrollyStep index={5}>

### æŸ¥çœ‹ç»“æœ

`result.done_tasks` åŒ…å« Reviewer å®¡æ‰¹é€šè¿‡çš„æ‰€æœ‰ä»»åŠ¡ã€‚æ¯ä¸ª `TeamTask` åŒ…å«ï¼š

- `id` â€” å”¯ä¸€ä»»åŠ¡ IDï¼ˆé¡ºåºç¼–å·ï¼Œä¾‹å¦‚ `task-1`ï¼‰
- `description` â€” Lead å‘å¸ƒçš„åŸå§‹ä»»åŠ¡æè¿°
- `result` â€” Worker çš„æ‰§è¡Œç»“æœæ–‡æœ¬
- `status` â€” æ­¤åˆ—è¡¨ä¸­å§‹ç»ˆä¸º `"done"`

`result.rejected_tasks` åŒ…å«ç»è¿‡ `max_rounds` ä»å¤„äº `"rejected"` çŠ¶æ€çš„ä»»åŠ¡â€”â€”è¿™äº›ä»»åŠ¡åœ¨è§„å®šè½®æ•°å†…æœªèƒ½é€šè¿‡å®¡æ‰¹ã€‚

</ScrollyStep>

<ScrollyStep index={6}>

### åº•å±‚ä»»åŠ¡æ¿æ“ä½œ

å¯ä»¥æ‰‹åŠ¨å‘å¸ƒä»»åŠ¡ã€å®Œå…¨ç»•è¿‡ Leadï¼Œç›´æ¥é©±åŠ¨ä»»åŠ¡æ¿ã€‚å½“ä»»åŠ¡åˆ—è¡¨å·²çŸ¥ã€åªéœ€å¹¶è¡Œæ‰§è¡ŒåŠ å®¡æ ¸æ—¶éå¸¸æœ‰ç”¨ã€‚

`board.stats()` è¿”å› `(open, in_progress, in_review, done, rejected)`â€”â€”å¯ç”¨äºè¿›åº¦æ¡æˆ–ç›‘æ§ä»ªè¡¨æ¿ã€‚

</ScrollyStep>

<ScrollyStep index={7}>

### å®Œæ•´æµæ°´çº¿

å®Œæ•´çš„ `review.py`ï¼Œè¿è¡Œæ–¹å¼ï¼š

```bash
python review.py "å®¡æŸ¥ auth æ¨¡å—çš„å®‰å…¨é—®é¢˜"
```

å¯ä»¥çœ‹åˆ° Lead åˆ†è§£ç›®æ ‡ã€Worker å¹¶è¡Œæ‰§è¡Œä»»åŠ¡ï¼ŒReviewer é€ä¸€éªŒè¯ç»“æœï¼Œå…¨éƒ¨é€šè¿‡åæ ‡è®°ä¸º Doneã€‚

</ScrollyStep>

</ScrollySteps>

<ScrollyCode>

```text é¡¹ç›®ç»“æ„
code-review/
â”œâ”€â”€ agent.hcl   # LLM æä¾›å•†é…ç½®
â””â”€â”€ review.py   # æµæ°´çº¿ï¼šç»„å»ºå›¢é˜Ÿ â†’ ç»‘å®š â†’ è¿è¡Œ â†’ æŸ¥çœ‹ç»“æœ
```

```hcl æ™ºèƒ½ä½“é…ç½®
# agent.hcl
default_model = "anthropic/claude-sonnet-4-20250514"

providers {
  name    = "anthropic"
  api_key = env("ANTHROPIC_API_KEY")
}
```

```python æ„å»ºå›¢é˜Ÿ
from a3s_code import Team, TeamRunner, TeamConfig

config = TeamConfig(
    max_tasks=30,        # ä»»åŠ¡æ¿å®¹é‡
    max_rounds=8,        # Reviewer è½®è¯¢ä¸Šé™
    poll_interval_ms=150,
)

team = Team("code-review", config)
team.add_member("lead",        "lead")     # åˆ†è§£ç›®æ ‡
team.add_member("worker-sec",  "worker")   # å®‰å…¨å®¡æŸ¥
team.add_member("worker-perf", "worker")   # æ€§èƒ½å®¡æŸ¥
team.add_member("reviewer",    "reviewer") # è´¨é‡æŠŠå…³

runner = TeamRunner(team)  # team åœ¨æ­¤å¤„è¢«æ¶ˆè€—
```

```python ç»‘å®š Session
from a3s_code import Agent

agent = Agent.create("agent.hcl")

# æ¯ä¸ªæˆå‘˜è·å¾—ç‹¬ç«‹çš„ Sessionï¼ˆç‹¬ç«‹çš„ä¸Šä¸‹æ–‡çª—å£ï¼‰
runner.bind_session("lead",        agent.session("."))
runner.bind_session("worker-sec",  agent.session("."))
runner.bind_session("worker-perf", agent.session("."))
runner.bind_session("reviewer",    agent.session("."))
```

```python è¿è¡Œå·¥ä½œæµ
goal = (
    "å®¡æŸ¥è®¤è¯æ¨¡å—ï¼ˆsrc/auth/ï¼‰ä¸­çš„é—®é¢˜ã€‚"
    "æ¶µç›–ï¼šJWT éªŒè¯ã€ä»¤ç‰Œè¿‡æœŸã€åˆ·æ–°æµç¨‹å’Œé”™è¯¯å¤„ç†ã€‚"
)

print(f"ç›®æ ‡ï¼š{goal}\n")
result = runner.run_until_done(goal)

print(f"\nå·¥ä½œæµå®Œæˆï¼š")
print(f"  âœ… å®Œæˆï¼š{len(result.done_tasks)} ä¸ªä»»åŠ¡")
print(f"  âŒ æ‹’ç»ï¼š{len(result.rejected_tasks)} ä¸ªä»»åŠ¡")
print(f"  ğŸ”„ è½®æ•°ï¼š{result.rounds}")
```

```python æŸ¥çœ‹ç»“æœ
for task in result.done_tasks:
    # æˆªå–ç»“æœå‰ 200 ä¸ªå­—ç¬¦ç”¨äºå±•ç¤º
    snippet = (task.result or "")[:200].replace("\n", " ")
    print(f"\nâ”€â”€ {task.description}")
    print(f"   {snippet}{'...' if len(task.result or '') > 200 else ''}")

if result.rejected_tasks:
    print("\næœªå®Œæˆçš„ä»»åŠ¡ï¼š")
    for task in result.rejected_tasks:
        print(f"  âš  {task.description}")
```

```python åº•å±‚ä»»åŠ¡æ¿æ“ä½œ
from a3s_code import Team, TeamRunner, TeamConfig

# è·³è¿‡ Leadï¼Œç›´æ¥æ‰‹åŠ¨å‘å¸ƒä»»åŠ¡
team = Team("manual-review")
team.add_member("lead",     "lead")
team.add_member("worker-1", "worker")
team.add_member("reviewer", "reviewer")

runner = TeamRunner(team)
runner.bind_session("lead",     agent.session("."))
runner.bind_session("worker-1", agent.session("."))
runner.bind_session("reviewer", agent.session("."))

board = runner.task_board()

# æ‰‹åŠ¨å‘å¸ƒä»»åŠ¡ï¼ˆç»•è¿‡ Lead åˆ†è§£ï¼‰
board.post("æ£€æŸ¥ src/auth/jwt.py ä¸­çš„ JWT è¿‡æœŸéªŒè¯",       "lead")
board.post("éªŒè¯ src/auth/refresh.py ä¸­çš„åˆ·æ–°ä»¤ç‰Œè½®æ¢",    "lead")
board.post("å®¡è®¡é”™è¯¯æ¶ˆæ¯ä¸­çš„ä¿¡æ¯æ³„éœ²é£é™©",                  "lead")

# è¿è¡Œå‰æŸ¥çœ‹ä»»åŠ¡æ¿çŠ¶æ€
(open_c, prog, rev, done, rej) = board.stats()
print(f"ä»»åŠ¡æ¿ï¼š{open_c} ä¸ªå¾…å¤„ç†ï¼Œ{done} ä¸ªå·²å®Œæˆ")
```

```python å®Œæ•´æµæ°´çº¿
# review.py
import sys
from a3s_code import Agent, Team, TeamRunner, TeamConfig

def main(goal: str):
    agent = Agent.create("agent.hcl")

    config = TeamConfig(max_tasks=30, max_rounds=8, poll_interval_ms=150)
    team = Team("code-review", config)
    team.add_member("lead",        "lead")
    team.add_member("worker-sec",  "worker")
    team.add_member("worker-perf", "worker")
    team.add_member("reviewer",    "reviewer")

    runner = TeamRunner(team)
    runner.bind_session("lead",        agent.session("."))
    runner.bind_session("worker-sec",  agent.session("."))
    runner.bind_session("worker-perf", agent.session("."))
    runner.bind_session("reviewer",    agent.session("."))

    print(f"ğŸš€ å¯åŠ¨ä»£ç å®¡æŸ¥æµæ°´çº¿\nç›®æ ‡ï¼š{goal}\n")
    result = runner.run_until_done(goal)

    print(f"\n{'â”€' * 60}")
    print(f"ç»“æœï¼š{len(result.done_tasks)} ä¸ªå®Œæˆï¼Œ"
          f"{len(result.rejected_tasks)} ä¸ªæ‹’ç»ï¼Œ"
          f"{result.rounds} è½®")
    print(f"{'â”€' * 60}")

    for task in result.done_tasks:
        snippet = (task.result or "")[:300].replace("\n", " ")
        print(f"\nâœ… {task.description}")
        print(f"   {snippet}{'...' if len(task.result or '') > 300 else ''}")

    if result.rejected_tasks:
        print(f"\nâš  æœªå®Œæˆä»»åŠ¡ï¼ˆ{len(result.rejected_tasks)} ä¸ªï¼‰ï¼š")
        for t in result.rejected_tasks:
            print(f"  â€¢ {t.description}")

if __name__ == "__main__":
    goal = sys.argv[1] if len(sys.argv) > 1 else (
        "å®¡æŸ¥è®¤è¯æ¨¡å—çš„å®‰å…¨é—®é¢˜"
    )
    main(goal)
```

</ScrollyCode>
</ScrollyCoding>

---

## è¿›é˜¶ç”¨æ³•

<Steps>

<Step>

### ä¸ºè§’è‰²æ·»åŠ ä¸“å±æŒ‡ä»¤

é€šè¿‡ `SessionOptions` ä¸ºæ¯ä¸ªè§’è‰²è®¾ç½®ä¸“æ³¨çš„èº«ä»½å’Œè§„èŒƒï¼š

```python
from a3s_code import SessionOptions

sec_opts = SessionOptions()
sec_opts.role = "ä½ æ˜¯ä¸€åä¸“æ³¨äºè®¤è¯ç³»ç»Ÿçš„å®‰å…¨å·¥ç¨‹å¸ˆã€‚"
sec_opts.guidelines = (
    "é‡ç‚¹å…³æ³¨ï¼šJWT éªŒè¯ã€ä»¤ç‰Œè¿‡æœŸã€CSRFã€ä¼šè¯å›ºå®šã€"
    "æ—¶åºæ”»å‡»ä»¥åŠé”™è¯¯æ¶ˆæ¯ä¸­çš„ä¿¡æ¯æ³„éœ²ã€‚"
    "å°½é‡å…·ä½“â€”â€”å¼•ç”¨æ–‡ä»¶è·¯å¾„å’Œè¡Œå·ã€‚"
)

perf_opts = SessionOptions()
perf_opts.role = "ä½ æ˜¯ä¸€åæ€§èƒ½å·¥ç¨‹å¸ˆã€‚"
perf_opts.guidelines = (
    "é‡ç‚¹å…³æ³¨ï¼šO(nÂ²) æ¨¡å¼ã€ç¼ºå¤±ç¼“å­˜ã€é˜»å¡ I/Oã€"
    "N+1 æŸ¥è¯¢ä»¥åŠä¸å¿…è¦çš„å¯†ç å­¦è¿ç®—ã€‚"
)

rev_opts = SessionOptions()
rev_opts.role = "ä½ æ˜¯ä¸€åè´Ÿè´£æœ€ç»ˆå®¡æ‰¹çš„é«˜çº§æŠ€æœ¯è´Ÿè´£äººã€‚"
rev_opts.guidelines = (
    "è‹¥ç»“æœå…·ä½“ã€å¯æ“ä½œä¸”å®Œæ•´è¦†ç›–ä»»åŠ¡ï¼Œåˆ™æ‰¹å‡†ã€‚"
    "è‹¥ç»“æœæ¨¡ç³Šã€ä¸å®Œæ•´æˆ–åç¦»ä¸»é¢˜ï¼Œåˆ™æ‹’ç»ã€‚"
)

runner.bind_session("worker-sec",  agent.session(".", sec_opts))
runner.bind_session("worker-perf", agent.session(".", perf_opts))
runner.bind_session("reviewer",    agent.session(".", rev_opts))
```

</Step>

<Step>

### æ‰©å±• Worker æ•°é‡

æ·»åŠ æ›´å¤šå…·æœ‰ç›¸åŒ `"worker"` è§’è‰²çš„æˆå‘˜ï¼Œä»¥åŠ å¿«ä»»åŠ¡å¤„ç†é€Ÿåº¦ã€‚æ‰€æœ‰ Worker å…±äº«åŒä¸€ä¸ªä»»åŠ¡æ¿â€”â€”`claim()` æ–¹æ³•æ˜¯åŸå­æ“ä½œï¼Œæ¯ä¸ªä»»åŠ¡åªä¼šè¢«æ‰§è¡Œä¸€æ¬¡ï¼š

```python
for i in range(4):
    team.add_member(f"worker-{i}", "worker")

runner = TeamRunner(team)
for i in range(4):
    runner.bind_session(f"worker-{i}", agent.session("."))
```

</Step>

<Step>

### TypeScript / Node.js

åŒæ ·çš„æµæ°´çº¿åœ¨ Node.js ä¸­å…·æœ‰å®Œå…¨ç›¸åŒçš„è¯­ä¹‰ï¼š

```typescript
import { Agent, Team, TeamRunner } from '@a3s-lab/code';

const agent = await Agent.create('agent.hcl');

const team = new Team('code-review', {
  maxRounds: 8, maxTasks: 30, channelBuffer: 128, pollIntervalMs: 150
});
team.addMember('lead',        'lead');
team.addMember('worker-sec',  'worker');
team.addMember('worker-perf', 'worker');
team.addMember('reviewer',    'reviewer');

const runner = new TeamRunner(team);
runner.bindSession('lead',        agent.session('.'));
runner.bindSession('worker-sec',  agent.session('.'));
runner.bindSession('worker-perf', agent.session('.'));
runner.bindSession('reviewer',    agent.session('.'));

const result = await runner.runUntilDone('å®¡æŸ¥è®¤è¯æ¨¡å—çš„å®‰å…¨é—®é¢˜');
console.log(`å®Œæˆï¼š${result.doneTasks.length} ä¸ªä»»åŠ¡ï¼Œ${result.rounds} è½®`);
```

</Step>

<Step>

### Rust

æè‡´æ€§èƒ½æ–¹æ¡ˆâ€”â€”ç›´æ¥å°†æµæ°´çº¿åµŒå…¥ Rust åº”ç”¨ï¼š

```rust
use a3s_code_core::{
    Agent, SessionOptions,
    agent_teams::{AgentTeam, TeamConfig, TeamRole, TeamRunner},
};
use std::sync::Arc;

let agent = Agent::new("agent.hcl").await?;

let config = TeamConfig {
    max_rounds: 8,
    poll_interval_ms: 150,
    ..TeamConfig::default()
};

let mut team = AgentTeam::new("code-review", config);
team.add_member("lead",        TeamRole::Lead);
team.add_member("worker-sec",  TeamRole::Worker);
team.add_member("worker-perf", TeamRole::Worker);
team.add_member("reviewer",    TeamRole::Reviewer);

let mut runner = TeamRunner::new(team);
runner.bind_session("lead",        Arc::new(agent.session(".", None)?))?;
runner.bind_session("worker-sec",  Arc::new(agent.session(".", None)?))?;
runner.bind_session("worker-perf", Arc::new(agent.session(".", None)?))?;
runner.bind_session("reviewer",    Arc::new(agent.session(".", None)?))?;

let result = runner.run_until_done("å®¡æŸ¥è®¤è¯æ¨¡å—çš„å®‰å…¨é—®é¢˜").await?;
println!("å®Œæˆï¼š{} ä¸ªä»»åŠ¡ï¼Œ{} è½®", result.done_tasks.len(), result.rounds);
```

</Step>

</Steps>

---

## å…³é”®æ¦‚å¿µ

| æ¦‚å¿µ | è¯´æ˜ |
|------|------|
| `AgentTeam` | å›¢é˜Ÿæ³¨å†Œä¸­å¿ƒâ€”â€”æŒæœ‰æˆå‘˜åˆ—è¡¨å’Œå…±äº«çš„ `TeamTaskBoard`ã€‚ä¼ å…¥ `TeamRunner` åè¢«æ¶ˆè€—ã€‚ |
| `TeamRunner` | æ‰§è¡Œå¼•æ“â€”â€”å°† `AgentSession` ç»‘å®šåˆ°æ¯ä¸ªæˆå‘˜ï¼Œé©±åŠ¨ Lead â†’ Worker â†’ Reviewer å¾ªç¯ã€‚ |
| `TeamTaskBoard` | çº¿ç¨‹å®‰å…¨çš„ä»»åŠ¡é˜Ÿåˆ—ã€‚çŠ¶æ€æµè½¬ï¼š`Open â†’ InProgress â†’ InReview â†’ Done`ï¼ˆæˆ– `Rejected â†’ Open` é‡è¯•ï¼‰ã€‚ |
| `TeamConfig.max_rounds` | Reviewer è½®è¯¢è½®æ•°ä¸Šé™ã€‚è¶…è¿‡åï¼Œå‰©ä½™ä»»åŠ¡ä»¥ `rejected_tasks` å½¢å¼è¿”å›ã€‚ |
| `claim()` | åŸå­è®¤é¢†â€”â€”è¿”å›ä¸‹ä¸€ä¸ª `Open` æˆ– `Rejected` çŠ¶æ€çš„ä»»åŠ¡å¹¶æ ‡è®°ä¸º `InProgress`ã€‚å¤š Worker å¹¶å‘è°ƒç”¨å®‰å…¨ã€‚ |
| Lead æç¤ºè¯ | å†…ç½®ã€‚æŒ‡ç¤º LLM è¿”å› `{"tasks": ["...", "..."]}` æ ¼å¼ï¼Œæ— éœ€è‡ªè¡Œç¼–å†™ã€‚ |
| Reviewer æç¤ºè¯ | å†…ç½®ã€‚æŒ‡ç¤º Reviewer å›å¤ `APPROVED: <ç†ç”±>` æˆ– `REJECTED: <åé¦ˆ>`ã€‚ |
