---
title: A3S Cron
description: Production-ready cron scheduling with natural language support, persistent storage, and OpenTelemetry observability
---

# A3S Cron

A3S Cron is a production-ready Rust cron scheduling library providing flexible task scheduling with natural language support in English and Chinese, persistent job storage, execution tracking, and OpenTelemetry observability.

## Key Features

- **Standard Cron Expressions** — 5-field format (`minute hour day month weekday`) with wildcards, ranges, steps, and lists.
- **Natural Language Scheduling** — Parse English (`"every 5 minutes"`, `"daily at 2am"`) and Chinese (`"每5分钟"`, `"每天凌晨2点"`) descriptions.
- **Job Management** — Create, update, pause, resume, and remove scheduled jobs with full CRUD API.
- **Manual Execution** — Trigger any job on demand, independent of its schedule.
- **Execution History** — Per-job execution records with stdout/stderr capture, exit codes, and timing.
- **Persistent Storage** — File-based JSON store with atomic writes. Pluggable `CronStore` trait for custom backends.
- **Event Subscription** — Broadcast channel for real-time job lifecycle events.
- **OpenTelemetry** — Span tracing and metrics (counters, histograms) for job execution monitoring.
- **Timeout Control** — Per-job configurable timeout with automatic cancellation.
- **Environment Variables** — Set per-job environment variables and working directory.

## Architecture

```
CronManager
├── CronStore (trait)              ← Persistence layer
│   ├── FileCronStore              ← JSON files with atomic writes
│   └── MemoryCronStore            ← In-memory for testing
│
├── CronExpression                 ← 5-field cron parser
│   ├── parse()                    ← Validate expression
│   ├── matches()                  ← Check if datetime matches
│   ├── next_after()               ← Calculate next run
│   └── describe()                 ← Human-readable description
│
├── parse_natural()                ← Natural language → cron
│   ├── English patterns
│   └── Chinese patterns
│
├── Scheduler Loop                 ← Background task (60s interval)
│   ├── Check Active jobs
│   ├── Execute matching jobs
│   └── Emit SchedulerEvents
│
└── Telemetry                      ← OpenTelemetry integration
    ├── Span: a3s.cron.execute_job
    ├── Counter: jobs_executed_total
    └── Histogram: job_duration_seconds
```

## File Storage Layout

```
{workspace}/.a3s/cron/
├── jobs.json                    # All job definitions
└── history/
    ├── {job-id-1}/
    │   ├── 1707734400000.json   # Execution record
    │   └── 1707734460000.json
    └── {job-id-2}/
        └── ...
```

## Test Coverage

71 unit tests across all modules — parser (16), natural language (49), store (12), scheduler (15), types (8).
