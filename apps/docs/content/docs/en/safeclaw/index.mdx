---
title: A3S SafeClaw
description: Security proxy for AI agents with PII classification, taint tracking, and confidential computing
---

import { TypeTable } from 'fumadocs-ui/components/type-table';

# A3S SafeClaw

SafeClaw is a security proxy for AI agents that runs inside an A3S Box VM. It classifies messages for PII, detects prompt injection attacks, sanitizes outputs, tracks data taint, and audits everything — with optional hardware-level memory encryption via TEE.

## Architecture

```
User Input
    ↓
┌─────────────────────────────────────────────────────┐
│ ZONE 1: Untrusted (Gateway)                         │
│  Privacy Classifier (detect PII)                    │
│  Injection Detector (block prompt injection)        │
│  Route decision: Local or TEE?                      │
└──────────────────┬──────────────────────────────────┘
                   │ Encrypted Channel (AES-256-GCM)
┌──────────────────▼──────────────────────────────────┐
│ ZONE 2: Trusted (TEE - Hardware Isolated)           │
│  Decrypt message                                    │
│  Process with AI agent (a3s-code)                   │
│  Output Sanitizer (redact tainted data)             │
│  Tool Interceptor (block dangerous commands)        │
└──────────────────┬──────────────────────────────────┘
                   ↓
Safe Output (PII redacted, audit logged)
```

## Defense in Depth

<TypeTable
  type={
    "L4: Application Security": {
      description: "Privacy Classifier, Policy Engine, Audit Logging, Session Isolation",
    },
    "L3: Protocol Security": {
      description: "Message Authentication (MAC), Replay Protection, Taint Tracking",
    },
    "L2: Channel Security": {
      description: "X25519 Key Exchange, AES-256-GCM Encryption, Forward Secrecy, Network Firewall",
    },
    "L1: Hardware Security (TEE)": {
      description: "Memory Isolation, Remote Attestation, Sealed Storage, CPU-level Encryption",
    },
  }
/>

## Core Components

<TypeTable
  type={
    "Privacy Classifier": {
      description: "Regex + semantic PII detection with pluggable backends",
    },
    "Policy Engine": {
      description: "Route decisions based on sensitivity level",
    },
    "Taint Registry": {
      description: "Track sensitive data through processing pipeline",
    },
    "Output Sanitizer": {
      description: "Redact tainted data from AI outputs",
    },
    "Injection Detector": {
      description: "Block prompt injection attacks",
    },
    "Tool Interceptor": {
      description: "Block dangerous tool calls (curl, wget, etc.)",
    },
    "Network Firewall": {
      description: "Whitelist-only outbound network access",
    },
    "Audit System": {
      description: "Forensic logging with severity levels and alerting",
    },
    "Session Manager": {
      description: "Per-session isolation with secure memory wipe",
    },
    "Channel Adapters": {
      description: "7 messaging platform integrations",
    },
    "Memory System": {
      description: "Three-layer memory with privacy gates",
    },
    "Secure Channel": {
      description: "X25519 + AES-256-GCM encrypted communication",
    },
  }
/>

## Key Statistics

<TypeTable
  type={
    "Source files": {
      description: "80+",
    },
    "Lines of Rust": {
      description: "28,248",
    },
    "Tests": {
      description: "609",
    },
    "API endpoints": {
      description: "34 (33 REST + 1 WebSocket)",
    },
    "Channel adapters": {
      description: "7",
    },
    "Sensitivity levels": {
      description: "5",
    },
    "Middleware integrations": {
      description: "a3s-gateway, a3s-lane, a3s-event",
    },
  }
/>

## Key Features

- **Multi-level PII classification** with regex, semantic, and compliance backends
- **Taint tracking** with variant detection (base64, hex, URL-encoded, reversed)
- **Prompt injection detection** with 5 attack categories
- **Tool call interception** blocking dangerous commands
- **Whitelist-only network firewall** with domain and protocol rules
- **Per-session isolation** with secure memory erasure
- **7 channel adapters**: Telegram, Slack, Discord, Feishu, DingTalk, WeCom, WebChat
- **Three-layer memory**: Resources → Artifacts → Insights with privacy gates
- **TEE integration**: AMD SEV-SNP, Intel SGX, ARM CCA support
- **Compliance engine**: HIPAA, PCI-DSS, GDPR rule sets
- **Cumulative risk tracking** across conversation turns
