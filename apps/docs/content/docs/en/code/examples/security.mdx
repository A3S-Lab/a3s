---
title: Security
description: Input taint tracking and output sanitization
---

import { Tab, Tabs } from 'fumadocs-ui/components/tabs';
import { TypeTable } from 'fumadocs-ui/components/type-table';
import { Callout } from 'fumadocs-ui/components/callout';

# Security

The `SecurityProvider` extension point intercepts every user prompt and LLM response to detect and redact sensitive data.

The built-in `DefaultSecurityProvider` detects common patterns: API keys, tokens, passwords, SSNs, credit card numbers, and email addresses.

## Enable Default Security

<Tabs groupId="lang" items={['Rust', 'Python', 'Node.js']}>
<Tab value="Rust">
```rust
use a3s_code_core::{Agent, SessionOptions};

let opts = SessionOptions::new()
    .with_permissive_policy()
    .with_default_security(); // taint input + sanitize output

let session = agent.session("/my-project", Some(opts))?;
let result = session.send("Review this config file", None).await?;
println!("{}", result.text); // sensitive patterns redacted
```

**Run:** `cargo run --example test_security`
**Source:** [`core/examples/test_security.rs`](https://github.com/A3S-Lab/Code/blob/main/core/examples/test_security.rs)
</Tab>
<Tab value="Python">
```python
from a3s_code import SessionOptions

opts = SessionOptions()
opts.default_security = True

session = agent.session("/my-project", options=opts)
result = await session.send("Review this config file")
print(result.text)  # sensitive patterns redacted
```

**Run:** `python examples/test_advanced_features.py`
**Source:** [`sdk/python/examples/test_advanced_features.py`](https://github.com/A3S-Lab/Code/blob/main/sdk/python/examples/test_advanced_features.py)
</Tab>
<Tab value="Node.js">
```javascript
const session = agent.session('/my-project', {
  permissive: true,
  defaultSecurity: true,
});

const result = await session.send('Review this config file');
console.log(result.text); // sensitive patterns redacted
```

**Run:** `node examples/test_advanced_features.js`
**Source:** [`sdk/node/examples/test_advanced_features.js`](https://github.com/A3S-Lab/Code/blob/main/sdk/node/examples/test_advanced_features.js)
</Tab>
</Tabs>

## Custom Security Provider

<Tabs groupId="lang" items={['Rust', 'Python', 'Node.js']}>
<Tab value="Rust">
```rust
use a3s_code_core::security::SecurityProvider;
use std::sync::Arc;

struct MySecurityProvider;

impl SecurityProvider for MySecurityProvider {
    fn taint_input(&self, text: &str) {
        // Detect and register sensitive patterns in input
        if text.contains("PRIVATE_KEY") {
            tracing::warn!("Sensitive input detected: private key reference");
        }
    }

    fn sanitize_output(&self, text: &str) -> String {
        // Redact sensitive patterns from LLM output
        text.replace(r"sk-[a-zA-Z0-9]{48}", "[REDACTED_API_KEY]")
    }

    fn wipe(&self) {
        // Clear any cached sensitive state
    }
}

let opts = SessionOptions::new()
    .with_permissive_policy()
    .with_security_provider(Arc::new(MySecurityProvider));

let session = agent.session("/my-project", Some(opts))?;
```
</Tab>
<Tab value="Python">
```python
# Custom security providers are implemented in Rust.
# Use with_default_security() for the built-in provider,
# or implement SecurityProvider in Rust and expose via FFI.
opts = SessionOptions()
opts.default_security = True
session = agent.session("/my-project", options=opts)
```
</Tab>
<Tab value="Node.js">
```javascript
// Custom security providers are implemented in Rust.
// Use defaultSecurity: true for the built-in provider.
const session = agent.session('/my-project', {
  defaultSecurity: true,
});
```
</Tab>
</Tabs>

## What Gets Redacted

The `DefaultSecurityProvider` detects and redacts:

<TypeTable
  type={
    "Anthropic API key": {
      description: {`Example: \`sk-ant-api03-...\` · Redacted as: \`[REDACTED]\``},
    },
    "OpenAI API key": {
      description: {`Example: \`sk-proj-...\` · Redacted as: \`[REDACTED]\``},
    },
    "Generic bearer token": {
      description: {`Example: \`Bearer eyJ...\` · Redacted as: \`[REDACTED]\``},
    },
    "Password field": {
      description: {`Example: \`password=secret\` · Redacted as: \`[REDACTED]\``},
    },
    "SSN": {
      description: {`Example: \`123-45-6789\` · Redacted as: \`[REDACTED]\``},
    },
    "Credit card": {
      description: {`Example: \`4111 1111 1111 1111\` · Redacted as: \`[REDACTED]\``},
    },
  }
/>

<Callout type="info">
For full security configuration, see [Security](/docs/code/security).
</Callout>

## API Reference

### SessionOptions

<TypeTable
  type={
    "Default security": {
      description: {`Rust: \`.with_default_security()\` · Python: \`default_security=True\` · Node.js: \`defaultSecurity: true\` · Default: \`false\``},
    },
    "Custom provider": {
      description: {`Rust: \`.with_security_provider(Arc::new(p))\` · Python: _(Rust only)_ · Node.js: _(Rust only)_ · Default: \`None\``},
    },
  }
/>

### SecurityProvider trait (Rust)

<TypeTable
  type={
    {`\`taint_input\``}: {
      description: {`Signature: \`fn taint_input(&self, text: &str)\` · Description: Inspect/register sensitive patterns in user input`},
    },
    {`\`sanitize_output\``}: {
      description: {`Signature: \`fn sanitize_output(&self, text: &str) -> String\` · Description: Redact sensitive patterns from LLM output`},
    },
    {`\`wipe\``}: {
      description: {`Signature: \`fn wipe(&self)\` · Description: Clear any cached sensitive state`},
    },
    {`\`register_hooks\``}: {
      description: {`Signature: \`fn register_hooks(&self, engine: &HookEngine)\` · Description: Attach hooks for deeper interception`},
    },
    {`\`teardown\``}: {
      description: {`Signature: \`fn teardown(&self)\` · Description: Called when session ends`},
    },
  }
/>

### DefaultSecurityProvider redaction patterns

<TypeTable
  type={
    "Anthropic API key": {
      description: {`Example match: \`sk-ant-api03-...\` · Replacement: \`[REDACTED]\``},
    },
    "OpenAI API key": {
      description: {`Example match: \`sk-proj-...\` · Replacement: \`[REDACTED]\``},
    },
    "Generic bearer token": {
      description: {`Example match: \`Bearer eyJ...\` · Replacement: \`[REDACTED]\``},
    },
    "Password field": {
      description: {`Example match: \`password=secret\` · Replacement: \`[REDACTED]\``},
    },
    "SSN": {
      description: {`Example match: \`123-45-6789\` · Replacement: \`[REDACTED]\``},
    },
    "Credit card": {
      description: {`Example match: \`4111 1111 1111 1111\` · Replacement: \`[REDACTED]\``},
    },
  }
/>
