---
title: Providers
description: Configure LLM providers, models, and per-model API key/base URL overrides
---

# Provider Configuration

All LLM providers and models are defined in the agent config file (HCL or JSON). Models are selected at runtime via `provider/model` format.

## Basic Configuration

```hcl
default_model = "anthropic/claude-sonnet-4-20250514"

providers {
  name    = "anthropic"
  api_key = "sk-ant-..."

  models {
    id        = "claude-sonnet-4-20250514"
    name      = "Claude Sonnet 4"
    family    = "claude-sonnet"
    tool_call = true
  }
}
```

## Multiple Providers

Define as many providers as needed. Switch between them at session creation via `provider/model`:

```hcl
default_model = "anthropic/claude-sonnet-4-20250514"

providers {
  name    = "anthropic"
  api_key = "sk-ant-..."

  models {
    id        = "claude-sonnet-4-20250514"
    name      = "Claude Sonnet 4"
    tool_call = true
  }

  models {
    id        = "claude-haiku-4-20250514"
    name      = "Claude Haiku 4"
    tool_call = true
  }
}

providers {
  name    = "openai"
  api_key = "sk-..."

  models {
    id        = "gpt-4o"
    name      = "GPT-4o"
    tool_call = true
  }

  models {
    id        = "gpt-4o-mini"
    name      = "GPT-4o Mini"
    tool_call = true
  }
}
```

Then select at runtime:

```rust
// Use default model (anthropic/claude-sonnet-4-20250514)
let session = agent.session("/project", None)?;

// Use a different model
let session = agent.session("/project", Some(
    SessionOptions::new().with_model("openai/gpt-4o")
))?;
```

## Per-Model API Key & Base URL

Models under the same provider can have different `api_key` and `base_url`. This is useful for:

- **API key rotation** — different keys for different models
- **Proxy endpoints** — route specific models through a proxy or gateway
- **Regional endpoints** — different base URLs for latency or compliance

```hcl
providers {
  name     = "anthropic"
  api_key  = "sk-ant-default-key..."          # default for all models
  base_url = "https://api.anthropic.com"      # default base URL

  models {
    id        = "claude-sonnet-4-20250514"
    name      = "Claude Sonnet 4"
    tool_call = true
    # inherits provider api_key and base_url
  }

  models {
    id        = "claude-sonnet-4-20250514-eu"
    name      = "Claude Sonnet 4 (EU)"
    api_key   = "sk-ant-eu-key..."              # override
    base_url  = "https://eu.api.anthropic.com"  # override
    tool_call = true
  }
}

providers {
  name    = "openai"
  api_key = "sk-team-key..."

  models {
    id        = "gpt-4o"
    name      = "GPT-4o"
    tool_call = true
    # inherits provider api_key
  }

  models {
    id        = "gpt-4o-mini"
    name      = "GPT-4o Mini"
    api_key   = "sk-personal-key..."   # different key for this model
    tool_call = true
  }
}
```

Provider-level `api_key` and `base_url` are defaults. Model-level values override them.

## Model Fields

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `id` | string | yes | Model identifier (e.g., `claude-sonnet-4-20250514`) |
| `name` | string | yes | Display name |
| `family` | string | no | Model family (e.g., `claude-sonnet`, `gpt`) |
| `api_key` | string | no | Per-model API key (overrides provider) |
| `base_url` | string | no | Per-model base URL (overrides provider) |
| `tool_call` | bool | no | Supports tool calling |
| `reasoning` | bool | no | Supports extended reasoning |
| `temperature` | bool | no | Supports temperature parameter |
| `attachment` | bool | no | Supports file attachments |
| `cost` | object | no | `{ input, output, cache_read, cache_write }` per million tokens |
| `limit` | object | no | `{ context, output }` token limits |

## Provider Fields

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `name` | string | yes | Provider identifier (used in `provider/model` format) |
| `api_key` | string | yes | Default API key for all models |
| `base_url` | string | no | Default base URL for all models |

## JSON Format

The same config in JSON:

```json
{
  "defaultModel": "anthropic/claude-sonnet-4-20250514",
  "providers": [
    {
      "name": "anthropic",
      "apiKey": "sk-ant-...",
      "models": [
        {
          "id": "claude-sonnet-4-20250514",
          "name": "Claude Sonnet 4",
          "toolCall": true
        },
        {
          "id": "claude-sonnet-4-20250514-eu",
          "name": "Claude Sonnet 4 (EU)",
          "apiKey": "sk-ant-eu-key...",
          "baseUrl": "https://eu.api.anthropic.com",
          "toolCall": true
        }
      ]
    }
  ]
}
```
