---
title: Streaming
description: Real-time event stream with AgentEvent
---

import { Tab, Tabs } from 'fumadocs-ui/components/tabs';

# Streaming

Subscribe to `AgentEvent` for real-time visibility into what the agent is doing â€” text deltas, tool calls, token usage, and more.

## Event Types

| Event | When |
|-------|------|
| `Start` | Agent begins processing |
| `TurnStart` / `TurnEnd` | Each LLM turn |
| `TextDelta` | Streaming text chunk |
| `ToolStart` / `ToolEnd` | Tool execution |
| `ToolOutputDelta` | Streaming tool output (bash) |
| `ContextResolving` / `ContextResolved` | RAG retrieval |
| `End` | Agent finished |

## Example

<Tabs groupId="lang" items={['Rust', 'Python', 'Node.js']}>
<Tab value="Rust">
```rust
use a3s_code_core::{Agent, AgentEvent, SessionOptions};

let session = agent.session("/my-project", Some(
    SessionOptions::new().with_permissive_policy()
))?;

let (mut rx, handle) = session.stream("Refactor the auth module", None).await?;

while let Some(event) = rx.recv().await {
    match event {
        AgentEvent::TextDelta { text } => print!("{text}"),
        AgentEvent::ToolStart { name, .. } => println!("\nðŸ”§ {name}..."),
        AgentEvent::ToolEnd { name, exit_code, .. } => {
            println!(" âœ“ (exit={})", exit_code);
        }
        AgentEvent::TurnEnd { turn, usage } => {
            println!("\nâ””â”€ Turn {turn} done ({} tokens)", usage.total_tokens);
        }
        AgentEvent::End { text, usage } => {
            println!("\nâ–  Done â€” {} tokens total", usage.total_tokens);
            break;
        }
        _ => {}
    }
}

handle.await??;
```

**Source:** [`core/examples/agentic_loop_demo.rs`](https://github.com/A3S-Lab/Code/blob/main/core/examples/agentic_loop_demo.rs)
</Tab>
<Tab value="Python">
```python
session = agent.session("/my-project", permissive=True)

async for event in session.stream("Refactor the auth module"):
    t = event.get("type")
    if t == "text_delta":
        print(event["text"], end="", flush=True)
    elif t == "tool_start":
        print(f"\nðŸ”§ {event['name']}...", end="")
    elif t == "tool_end":
        print(f" âœ“ (exit={event['exit_code']})")
    elif t == "turn_end":
        print(f"\nâ””â”€ Turn {event['turn']} done ({event['usage']['total_tokens']} tokens)")
    elif t == "end":
        print(f"\nâ–  Done â€” {event['usage']['total_tokens']} tokens total")
        break
```

**Source:** [`sdk/python/examples/agentic_loop_demo.py`](https://github.com/A3S-Lab/Code/blob/main/sdk/python/examples/agentic_loop_demo.py)
</Tab>
<Tab value="Node.js">
```javascript
const session = agent.session('/my-project', { permissive: true });

const stream = await session.stream('Refactor the auth module');

for await (const event of stream) {
  switch (event.type) {
    case 'text_delta':
      process.stdout.write(event.text);
      break;
    case 'tool_start':
      process.stdout.write(`\nðŸ”§ ${event.name}...`);
      break;
    case 'tool_end':
      console.log(` âœ“ (exit=${event.exitCode})`);
      break;
    case 'turn_end':
      console.log(`\nâ””â”€ Turn ${event.turn} done (${event.usage.totalTokens} tokens)`);
      break;
    case 'end':
      console.log(`\nâ–  Done â€” ${event.usage.totalTokens} tokens total`);
      break;
  }
}
```

**Source:** [`sdk/node/examples/agentic_loop_demo.js`](https://github.com/A3S-Lab/Code/blob/main/sdk/node/examples/agentic_loop_demo.js)
</Tab>
</Tabs>

## Sample Output

```
â”Œâ”€ Turn 1
ðŸ”§ read... âœ“ (exit=0)
ðŸ”§ write... âœ“ (exit=0)
â””â”€ Turn 1 done (1842 tokens)
â”Œâ”€ Turn 2
The auth module has been refactored. Key changes:
- Extracted JWT validation into a separate function
- Added proper error types
- Improved test coverage
â””â”€ Turn 2 done (2103 tokens)
â–  Done â€” 3945 tokens total
```

## API Reference

### stream()

| Method | Rust | Python | Node.js |
|--------|------|--------|---------|
| Start stream | `session.stream("prompt", None).await?` | `session.stream("prompt")` | `session.stream('prompt')` |
| Receive event | `rx.recv().await` | `async for event in stream` | `for await (const event of stream)` |
| Await completion | `handle.await??` | _(auto)_ | _(auto)_ |

### AgentEvent types

| Event | Rust variant | Python/Node.js `type` | Fields |
|-------|-------------|----------------------|--------|
| Agent started | `AgentEvent::Start` | `start` | â€” |
| LLM turn began | `AgentEvent::TurnStart` | `turn_start` | `turn` |
| LLM turn ended | `AgentEvent::TurnEnd` | `turn_end` | `turn`, `usage` |
| Text chunk | `AgentEvent::TextDelta` | `text_delta` | `text` |
| Tool began | `AgentEvent::ToolStart` | `tool_start` | `name`, `args` |
| Tool finished | `AgentEvent::ToolEnd` | `tool_end` | `name`, `exit_code`, `output` |
| Tool output chunk | `AgentEvent::ToolOutputDelta` | `tool_output_delta` | `text` |
| RAG resolving | `AgentEvent::ContextResolving` | `context_resolving` | `query` |
| RAG resolved | `AgentEvent::ContextResolved` | `context_resolved` | `chunks` |
| Agent finished | `AgentEvent::End` | `end` | `text`, `usage` |
