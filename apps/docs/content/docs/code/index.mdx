---
title: A3S Code
description: Embeddable AI coding agent framework in Rust with native Node.js and Python bindings
---

import { Tab, Tabs } from 'fumadocs-ui/components/tabs';

# A3S Code

**Embeddable AI coding agent framework in Rust** — Build AI agents that can read, write, and execute code with full tool access, planning, and multi-language SDKs.

```rust
let agent = Agent::new("agent.hcl").await?;
let session = agent.session("/my-project", None)?;
let result = session.send("Refactor auth to use JWT").await?;
```

## Why A3S Code?

- **Embeddable** — Rust library with Node.js and Python bindings
- **Production-Ready** — Permission system, HITL confirmation, cost tracking
- **Extensible** — 10 built-in tools + MCP protocol for external tools
- **Intelligent** — Parallel plan execution, goal tracking, memory system

## Quick Start

<Tabs groupId="lang" items={['Rust', 'TypeScript', 'Python']}>
<Tab value="Rust">
```rust
use a3s_code_core::{Agent, AgentEvent};

let agent = Agent::new("agent.hcl").await?;
let session = agent.session("/my-project", None)?;

// Non-streaming
let result = session.send("What files handle auth?").await?;
println!("{}", result.text);

// Streaming
let (mut rx, _) = session.stream("Refactor auth").await?;
while let Some(event) = rx.recv().await {
    match event {
        AgentEvent::TextDelta { text } => print!("{text}"),
        AgentEvent::End { .. } => break,
        _ => {}
    }
}
```
</Tab>
<Tab value="TypeScript">
```typescript
const { Agent } = require('@a3s-lab/code');

const agent = await Agent.create('agent.hcl');
const session = agent.session('/my-project');

// Non-streaming
const result = await session.send('What files handle auth?');
console.log(result.text);

// Streaming
for await (const event of session.stream('Refactor auth')) {
  if (event.type === 'text_delta') {
    process.stdout.write(event.text);
  }
}
```
</Tab>
<Tab value="Python">
```python
from a3s_code import Agent

agent = Agent.create("agent.hcl")
session = agent.session("/my-project")

# Non-streaming
result = session.send("What files handle auth?")
print(result.text)

# Streaming
for event in session.stream("Refactor auth"):
    if event.event_type == "text_delta":
        print(event.text, end="", flush=True)
```
</Tab>
</Tabs>

## Core Features

### Built-in Tools (10)

**File Operations:** `read`, `write`, `edit`, `patch`, `grep`, `glob`, `ls`
**Execution:** `bash`
**Web:** `web_fetch`, `web_search`

See [Tools](/docs/code/tools) for full reference.

### Permission System

```rust
// Allow/Deny/Ask rules per tool
session.set_permission_policy(PermissionPolicy::new()
    .allow("read(*)")
    .deny("bash(rm -rf:*)")
    .ask("write(*)")
).await;
```

See [Sessions → Permissions](/docs/code/sessions#permissions) for details.

### Planning & Parallel Execution

```rust
let session = agent.session("/project", Some(
    SessionOptions::new()
        .with_planning(true)
        .with_goal_tracking(true)
))?;

// Agent decomposes task into parallel steps
session.send("Refactor auth + update tests").await?;
```

Independent steps execute in parallel automatically. See [Tasks](/docs/code/tasks) for details.

### Multi-Machine Distribution

```rust
// Offload tool execution to remote workers
session.set_lane_handler(SessionLane::Execute, LaneHandlerConfig {
    mode: TaskHandlerMode::External,
    timeout_ms: 120_000,
}).await;

// Poll for tasks and dispatch to workers
let tasks = session.pending_external_tasks().await;
for task in tasks {
    let result = send_to_remote_worker(&task).await;
    session.complete_external_task(&task.task_id, result).await;
}
```

See [Lane Queue → External Tasks](/docs/code/lane-queue#external-task-handling) for details.

## Advanced Features

<details>
<summary><b>Human-in-the-Loop (HITL)</b></summary>

```rust
// Require confirmation before sensitive operations
let session = agent.session("/project", Some(
    SessionOptions::new()
        .with_confirmation_policy(ConfirmationPolicy::enabled())
))?;

// Agent will emit ConfirmationRequired events
// Respond via session.confirm_tool(tool_id, approved).await
```

See [Sessions → HITL](/docs/code/sessions#human-in-the-loop) for details.

</details>

<details>
<summary><b>Lifecycle Hooks</b></summary>

```rust
// 8 hook events: PreToolUse, PostToolUse, GenerateStart, GenerateEnd, etc.
let hook_engine = HookEngine::new();
hook_engine.register(Hook::new("security-check", HookEventType::PreToolUse));

let session = agent.session("/project", Some(
    SessionOptions::new().with_hook_engine(hook_engine)
))?;
```

See [Hooks](/docs/code/hooks) for details.

</details>

<details>
<summary><b>Memory System</b></summary>

```rust
// 4 memory types: episodic, semantic, procedural, working
session.remember_success("Implemented JWT", &["auth", "security"]).await?;
let memories = session.recall("authentication").await?;
```

See [Memory](/docs/code/memory) for details.

</details>

<details>
<summary><b>MCP Integration</b></summary>

```rust
// Connect to external tools via Model Context Protocol
let mcp_client = McpClient::connect_stdio("path/to/mcp-server").await?;
session.add_mcp_client(mcp_client).await;
```

See [MCP](/docs/code/mcp) for details.

</details>

<details>
<summary><b>Cost Tracking</b></summary>

```rust
// Per-session token cost calculation
let usage = session.context_usage().await?;
println!("Cost: ${:.4}", usage.total_cost);
```

See [Telemetry](/docs/code/telemetry) for details.

</details>

## Configuration

Minimal config file (`agent.hcl`):

```hcl
default_model = "anthropic/claude-sonnet-4-20250514"

providers {
  name    = "anthropic"
  api_key = "sk-ant-..."
}
```

<details>
<summary><b>Complete Configuration Example</b></summary>

```hcl
default_model = "anthropic/claude-sonnet-4-20250514"

max_tool_rounds  = 20
thinking_budget  = 4096
storage_backend  = "file"
sessions_dir     = "/tmp/a3s"

providers {
  name    = "anthropic"
  api_key = "sk-ant-..."

  models {
    id          = "claude-sonnet-4-20250514"
    name        = "Claude Sonnet 4"
    tool_call   = true
    cost {
      input       = 3.0
      output      = 15.0
      cache_read  = 0.3
      cache_write = 3.75
    }
    limit {
      context = 200000
      output  = 8192
    }
  }
}

providers {
  name     = "openai"
  api_key  = "sk-..."
  base_url = "https://api.openai.com"

  models {
    id        = "gpt-4o"
    name      = "GPT-4o"
    tool_call = true
  }
}
```

See [Providers](/docs/code/providers) for full reference.

</details>

## Architecture

```
Agent (config-driven)
  ├─ LlmClient (Anthropic/OpenAI)
  ├─ SessionManager (multi-session)
  └─ AgentSession (workspace-bound)
       ├─ AgentLoop (execution engine)
       ├─ ToolExecutor (10 tools)
       ├─ LlmPlanner (parallel execution)
       ├─ PermissionSystem
       ├─ HookEngine (8 events)
       ├─ Memory (4 types)
       ├─ MCP (external tools)
       └─ Cost Tracking
```

See [Architecture](/docs/code/architecture) for details.

## Documentation

- **[Sessions](/docs/code/sessions)** — Session management, permissions, HITL
- **[Tasks](/docs/code/tasks)** — Planning, parallel execution, goal tracking
- **[Tools](/docs/code/tools)** — Built-in tools reference
- **[Lane Queue](/docs/code/lane-queue)** — Priority routing, external task offloading
- **[Subagents](/docs/code/subagents)** — Delegate tasks to specialized agents
- **[Hooks](/docs/code/hooks)** — Lifecycle events and custom logic
- **[Memory](/docs/code/memory)** — Episodic, semantic, procedural, working memory
- **[MCP](/docs/code/mcp)** — External tool integration via Model Context Protocol
- **[Telemetry](/docs/code/telemetry)** — Cost tracking and usage metrics
- **[Providers](/docs/code/providers)** — LLM provider configuration
