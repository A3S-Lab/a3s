---
title: Permissions & HITL
description: Fine-grained tool access control and human-in-the-loop confirmation
---

# Permissions & HITL

A3S Code provides two independent layers of access control: a rule-based permission system and a human-in-the-loop (HITL) confirmation system. They work together but are evaluated independently.

## Permission System

Permissions control which tools the agent can use. Rules are evaluated in order: Deny → Allow → Ask → Default.

### Rule Types

| Action | Behavior |
|--------|----------|
| `deny` | Block the tool call immediately |
| `allow` | Permit the tool call |
| `ask` | Prompt the user for confirmation |

### Rule Format

Rules use glob-style pattern matching on tool names and arguments:

```
Tool(pattern)
```

- `Bash(rm -rf:*)` — matches any bash command starting with `rm -rf`
- `Read(src/**)` — matches read operations on any file under `src/`
- `Write(*)` — matches all write operations
- MCP tools use prefix matching: `mcp__server` matches `mcp__server__tool`

## Human-in-the-Loop (HITL)

HITL is independent of the permission system. Even if a tool is `allow`-ed by permissions, it still goes through the HITL check. This provides defense-in-depth.

### Timeout Behavior

| Action | Behavior |
|--------|----------|
| `reject` | Reject the tool call on timeout (recommended) |
| `auto_approve` | Auto-approve on timeout (use with caution) |

## Evaluation Order

When the agent wants to execute a tool, the following checks happen in order:

1. **SecurityGuard hooks** (priority 1) — taint tracking, injection detection
2. **Permission policy** — Deny → Allow → Ask → Default
3. **HITL confirmation** — independent check, even if permissions say Allow
4. **Guard policy** — defense-in-depth check on ToolExecutor
5. **Skill tool filters** — per-skill `allowed_tools` restrictions

Any layer can block the tool call. All layers must pass for execution to proceed.
