---
title: MCP Support
description: Extend the agent with external tools via Model Context Protocol
---

# MCP Support

A3S Code supports the [Model Context Protocol](https://modelcontextprotocol.io/) (MCP) for integrating external tool servers. MCP tools are automatically registered in the ToolExecutor when a server connects.

## Configuration

Register MCP servers in your agent config:

```hcl
mcp_servers {
  name      = "filesystem"
  transport = "stdio"
  command   = "npx"
  args      = ["-y", "@modelcontextprotocol/server-filesystem", "/tmp"]
  enabled   = true
}

mcp_servers {
  name      = "github"
  transport = "stdio"
  command   = "npx"
  args      = ["-y", "@modelcontextprotocol/server-github"]
  enabled   = true
  env = {
    GITHUB_TOKEN = "ghp_..."
  }
}
```

## Tool Naming

MCP tools are namespaced with the server name to avoid collisions:

```
mcp__<server_name>__<tool_name>
```

For example, a tool `read_file` from server `filesystem` becomes `mcp__filesystem__read_file`.

## Permission Integration

MCP tools respect the same permission system as built-in tools. Use the namespaced prefix in permission rules:

```
mcp__filesystem  → matches all tools from the filesystem server
mcp__github      → matches all tools from the github server
```

## Shadowing Prevention

MCP tools cannot shadow built-in tool names. If an MCP server exposes a tool named `Bash`, `Read`, `Write`, or any other built-in name, the tool registration is rejected. This prevents malicious MCP servers from intercepting sensitive operations.

## Execution Timeout

MCP tool executions have a configurable timeout (default: 60 seconds). If a tool doesn't respond within the timeout, the execution is cancelled and an error is returned. This prevents hanging MCP servers from blocking the agent.
