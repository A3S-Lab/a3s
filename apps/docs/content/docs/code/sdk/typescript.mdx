---
title: TypeScript SDK
description: Native napi-rs bindings for A3S Code
---

# TypeScript SDK

The `@a3s-lab/code` package provides native napi-rs bindings to `a3s-code-core`. Zero IPC overhead, direct function calls.

## Installation

```bash
npm install @a3s-lab/code
```

## Create Agent

```typescript
const { Agent } = require('@a3s-lab/code');

// From config file (.hcl or .json)
const agent = await Agent.create('agent.hcl');

// From inline JSON string
const agent = await Agent.create('{"defaultModel": "anthropic/claude-sonnet-4-20250514", ...}');
```

## Create Session

```typescript
// Default session (uses config's default model)
const session = agent.session('/my-project');

// Override model for this session
const session = agent.session('/my-project', {
  model: 'openai/gpt-4o',
});
```

## Send (Non-Streaming)

```typescript
const result = await session.send('What files handle authentication?');
console.log(result.text);
console.log(`Tools: ${result.toolCallsCount}, Tokens: ${result.totalTokens}`);
```

## Stream

```typescript
const events = await session.stream('Refactor the auth module');
for (const event of events) {
  if (event.type === 'text_delta') process.stdout.write(event.text);
  if (event.type === 'tool_start') console.log(`\nðŸ”§ ${event.toolName}`);
  if (event.type === 'tool_end') console.log(`  â†’ ${event.toolOutput?.slice(0, 100)}`);
}
```

## Direct Tool Execution

```typescript
// Generic tool call
const result = await session.tool('bash', { command: 'cargo test' });
console.log(`[${result.exitCode}] ${result.output}`);

// Convenience wrappers
const content = await session.readFile('src/main.rs');
const output = await session.bash('git status');
const files = await session.glob('**/*.ts');
const matches = await session.grep('export function');
```

## Return Types

```typescript
interface AgentResult {
  text: string;
  toolCallsCount: number;
  promptTokens: number;
  completionTokens: number;
  totalTokens: number;
}

interface AgentEvent {
  type: 'start' | 'text_delta' | 'tool_start' | 'tool_end'
      | 'tool_output_delta' | 'turn_start' | 'turn_end' | 'end' | 'error';
  text?: string;
  toolName?: string;
  toolId?: string;
  toolOutput?: string;
  exitCode?: number;
  turn?: number;
  prompt?: string;
  error?: string;
  totalTokens?: number;
}

interface ToolResult {
  name: string;
  output: string;
  exitCode: number;
}

interface SessionOptions {
  model?: string;  // "provider/model" format
}
```
